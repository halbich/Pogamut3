<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>UT2004 Maps Generator</title>

  <section>
    <title>What will you learn?</title>

    <para>In this tutorial you will learn about:</para>

    <para><itemizedlist>
        <listitem>
          <para>UT2004 maps generator tool</para>
        </listitem>

        <listitem>
          <para>How use the map generator to make a new map</para>
        </listitem>

        <listitem>
          <para>How to import the map to UT2004</para>
        </listitem>
      </itemizedlist>Estimated time for completing this tutorial is X
    minutes.</para>
  </section>

  <section>
    <title>Prerequisites</title>

    <para>Before taking this tutorial it is expected that you are familiar
    with:</para>

    <itemizedlist>
      <listitem>
        <para>-</para>
      </listitem>
    </itemizedlist>
  </section>

  <section>
    <title>Tutorial body</title>

    <para>UT2004MapsGenerator (<link xlink:href="http://diana.ms.mff.cuni.cz/pogamut_files/misc/UT2004MapGenerator-Package_2010-09-07.zip">DOWNLOAD</link>) is a tool for easy and fast generating
    of sample maps with possibility of random adjustment of various parameters.
    The basic properties of each level can be set in “UT2004MapsGenerator.ini” file.
    And the special properties of each map type can be set in ”&lt;map_type&gt;.ini” files. </para>

    <para> Each map type has a set of properties, which are for each generated level
    chosen randomly and cannot be set from outside (e.g. layout of the boxes in lava
    level or the shape of the maze). </para>

    <para> Each map is generated into .t3d format and needs to be built in UnreadEd.exe
    tool before can be used (for more info, see “Building maps in UnrealEd.exe”). </para>

    <para> Map generator is a console tool that is run from the command line. Rest
    of this tutorial will guide you through the map generation process. </para>

    <section>
      <title>UT2004 Maps Generator content</title>

      <para> UT2004 Maps Generator folder structure:
      <itemizedlist>
        <listitem>
          <para> <guimenuitem>Binary</guimenuitem> - folder containing UT2004 Maps Generator executables
              <itemizedlist>
                <listitem>
                    <para><guimenuitem>Reference bots</guimenuitem> - directory containing compiled preprapered reference
                        bots that are capable of surviving on the example maps (source code not provided)</para>
                    </listitem>

                <listitem>
                  <para><guimenuitem>UT2004MapsGenerator</guimenuitem> - directory with the tool itself.
                    Three .bat files generating three possible map types are preprapered in this directory.
                    You will find here also the .ini files configuring the map generator tool.</para>
                </listitem>
                </itemizedlist>
          </para>
        </listitem>

        <listitem>
          <para><guimenuitem>Testing environments</guimenuitem> - folder containing nine
            example maps generated by the tool (tool setting is provided) ready to play in Unreal Tournament 2004.
              <itemizedlist>
                <listitem>
                    <para><guimenuitem>Lava</guimenuitem> - contains three example lava
                    type maps. Lava map contains of a lava field with several small islands that
                    can be jumped between each other. The bot has to adjust its jumping
                    according to gravitation level in the map (this level differs from map to map).</para>
                    </listitem>
                <listitem>
                  <para><guimenuitem>Maze</guimenuitem> - contains three example maze type
                  maps. Maze map consists of a maze with health items (increasing bot health).
                  The map is radioactive, so the bot slowly loses health. The goal of
                  the bot is to survive as long as possible in this maze.</para>
                </listitem>
                <listitem>
                  <para><guimenuitem>Water</guimenuitem> - contains three example water
                  type maps. Water map is a capture the flag map. This means that two
                  flags are in the level and the bots goal is to take opponents flag and
                  carry it to his home base. Water map consists of a pool full of acid water
                  that separates home and opponent base. It is not possible to get through
                  the whole pool on one shot. The bot has to make break on the way to
                  take health item that is situated in the half of the distance between bases.</para>
                </listitem>
              </itemizedlist>
          </para>
        </listitem>
      </itemizedlist>
      </para>

      <para><guimenuitem>Acknowledgment</guimenuitem> UT2004MapsGenerator was implemented
      by Michal Danilak. </para>
    </section>

    <section>
      <title>Generating the map</title>

      <para>In this section we will guide you through the process of using UT2004MapsGenerator
      tool to generate the map. There are three different types of maps that can be
      generated through UT2004MapGenerator. The exact shape of the generated maps
      is influenced by the parameters in the .ini files. Three types of maps are:
      <itemizedlist>
          <listitem>
            <para>Lava map - lava field map with islands and varied gravity</para>
          </listitem>
          <listitem>
            <para>Maze map - radioactive map with health items scattered around</para>
          </listitem>

          <listitem>
            <para>Water map - capture the flag map with bases separated by acid water</para>
          </listitem>
        </itemizedlist>
      </para>

      <section>
        <title>Generating .t3d file</title>
      <para> First step of map generation with UT2004MapsGenerator is to generate .t3d
      file through <literal>UT2004MapsGenerator.exe</literal>. The file can be found
      in folder: <code> ..\UT2004MapGenerator-Package\Binary\UT2004MapsGenerator\ </code>.
      UT2004MapsGenerator can be run from the console with typing:
      <code>
          UT2004MapsGenerator.exe -map &lt;map_type&gt; [optional_parameters]
      </code></para>
      <para><guimenuitem> Meaning of the parameters is following:</guimenuitem>
      <itemizedlist>
          <listitem>
            <para>-h - shows help</para>
          </listitem>
          <listitem>
            <para>-map &lt;map_type&gt; - specifies a type of map to be generated (water, maze, lava)
            <programlisting>
                Example: -map lava
                Available map types: lava, maze, water
            </programlisting>
            </para>
          </listitem>

          <listitem>
            <para>-dir&lt;dest_dir&gt; - specifies a destination directory, into which will be maps generated
            <programlisting>
                Example: -dir Maps/
            </programlisting></para>
          </listitem>

          <listitem>
            <para>-n &lt;num&gt; - specifies a number of maps to be generated of a selected type
            <programlisting>
                Example: -n 10
            </programlisting></para>
          </listitem>
          <listitem>
            <para>-file &lt;file_name&gt; - specifies a file name for the generated maps. When multiple maps are generated, then a unique ID is appended to each file.
            <programlisting>
                Example: -file myLevel
            </programlisting></para>
          </listitem>
        </itemizedlist>
    </para>
    <para> You may use GenerateMap-Lava.bat, GenerateMap-Maze.bat, GenerateMap-Water.bat
    to generate one map with current settings (.bat files contains examples how
    to call UT2004MapGenerator.exe).
    </para>

    <para> Run GenerateMap-Maze.bat to generate your first maze map. .t3d file called
    <guimenuitem>DM-MazeMap.t3d</guimenuitem> should appear in <code> ..\UT2004MapGenerator-Package\Binary\UT2004MapsGenerator\ </code>.

    </para>
      </section>
      <section>
        <title>Building .t3d file in UnrealEd</title>
        <para>Second step of map generation process is to build and save the map in
        UT2004 format through UnrealEd. UnrealEd is a free map editor that comes with
        the game Unreal Tournament 2004. Run it by executing: <code>../UT2004/System/UnrealEd.exe</code></para>

        <para>
            Click <guimenuitem>File</guimenuitem> and select <guimenuitem>Import...</guimenuitem>
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/UT2004MapsGenerator/UT2004MapGenerator1.jpg"></imagedata>
            </imageobject>
          </mediaobject>  
          
        </para>
        <para>
            Find and select your .t3d generated file (1.) and click <guimenuitem>Open</guimenuitem> (2.).
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/UT2004MapsGenerator/UT2004MapGenerator2.jpg"></imagedata>
            </imageobject>
          </mediaobject>
          
        </para>
        <para>
            Confirm importing by pressing <guimenuitem>Ok</guimenuitem>. Leave the field unchecked.
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/UT2004MapsGenerator/UT2004MapGenerator3.jpg"></imagedata>
            </imageobject>
          </mediaobject>
          
        </para>
        <para>
            Click <guimenuitem>Build All</guimenuitem> button and wait until the map will be built.
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/UT2004MapsGenerator/UT2004MapGenerator4.jpg"></imagedata>
            </imageobject>
          </mediaobject>
          
        </para>
        <para>
            Save the map in UT2004 format, so it may be used by UT2004.
          <mediaobject>
            <imageobject>
              <imagedata fileref="media/UT2004MapsGenerator/UT2004MapGenerator5.jpg"></imagedata>
            </imageobject>
          </mediaobject>         
        </para>
      </section>

      <para> When you are done and the map is saved, you may play it with Unreal Tournament 2004.
      Just run UT2004.exe, host the game and select your newly generated map with some
      GameBots gametype.</para>
     
    </section>
  </section>

  <section>
    <title>Where to continue</title>

    <para>TODO</para>
  </section>
</chapter>
